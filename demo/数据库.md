-- 用户表：存储系统用户基本信息
CREATE TABLE `user` (
  `user_id` INT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT '用户唯一ID（主键）',
  `username` VARCHAR(50) NOT NULL COMMENT '用户名（登录/展示用）',
  `phone` VARCHAR(20) NULL DEFAULT NULL COMMENT '手机号（可选，用于登录/验证）',
  `email` VARCHAR(100) NULL DEFAULT NULL COMMENT '邮箱（可选，用于登录/验证）',
  `password_hash` VARCHAR(100) NOT NULL COMMENT '密码哈希（加密存储）',
  `create_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '用户创建时间',
  `update_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '信息更新时间',
  PRIMARY KEY (`user_id`),
  UNIQUE KEY `uk_username` (`username`) COMMENT '用户名唯一，避免重复注册',
  UNIQUE KEY `uk_phone` (`phone`) COMMENT '手机号唯一（若填写）',
  UNIQUE KEY `uk_email` (`email`) COMMENT '邮箱唯一（若填写）'
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='系统用户表';

-- 用户关注新闻表：存储用户与新闻的关注关系
CREATE TABLE `user_follow_news` (
  `follow_id` INT UNSIGNED NOT NULL AUTO_INCREMENT COMMENT '关注记录唯一ID（主键）',
  `user_id` INT UNSIGNED NOT NULL COMMENT '关联用户表的user_id（外键）',
  `news_id` VARCHAR(50) NOT NULL COMMENT '新闻唯一标识（如来源平台的新闻ID）',
  `news_title` VARCHAR(200) NOT NULL COMMENT '新闻标题（便于本地查看）',
  `image_url` VARCHAR(500) NULL DEFAULT NULL COMMENT '图片链接（可选，用于展示新闻相关图片）',
  `news_content` TEXT NULL DEFAULT NULL COMMENT '新闻正文',
  `follow_time` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '关注时间',
  PRIMARY KEY (`follow_id`),
  -- 外键约束：关联用户表，用户删除时同步删除其关注记录
  FOREIGN KEY (`user_id`) REFERENCES `user` (`user_id`) ON DELETE CASCADE,
  -- 联合唯一约束：避免用户重复关注同一篇新闻
  UNIQUE KEY `uk_user_news` (`user_id`, `news_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COMMENT='用户关注新闻记录表';